<html>
<h1>EPP.com - Login</h1>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login Page</title>

    <link rel="stylesheet" href="styles.css">
</head>
<!--these create the buttons that take the user to the home and about page -->
<body onload="get()">
    <a href="index.html"><button onclick="index.html"> Home </button></a>
    <a href="about.html"><button onclick="about.html"> About </button></a>
    <!-- <div class="alert-box"><p class="alert">Error</p></div> -->

    <p id="savedText"> </p>
    <p id="openedText"> </p>
<!-- this creates the elements that allow the user to type in their name, password and login with the "log in" button-->
    <div class="form" id = login_field>
        <br>
        <input type="text" name="username" placeholder="Your Name" autocomplete="off" class="your-name" id="username" required>
        <input type="password" name="password" placeholder="Password" autocomplete="off" class="password" id="password" required>
        <br><br>
        <button onclick="save()" class="submit-btn" id = "login">Log In</button>
        <br>
        <p>Name/password are only for this event.<br>New to this event? Make up a password.<br>Returning? Use the same name/password.</p>
        <!-- <a href="#" class="link">don't have an account? Register one</a> -->
    </div>
<!-- this is a hidden element that allows the user to type in how many events they want, once it's been revealed -->
    <div id = "eventplanneroptions" hidden>
      <p> How many events do you want?</p>
      <input type = "text" name = "number-of-events" placeholder = "Number of events" autocomplete="off" id = "number-of-events" required >
      <br><br>     
      <button id = "generate">generate</button>
    </div>
<!-- this is a hidden element that welcomes a user who has previously logged in-->
    <div id = "successfulLogin_field" hidden>
      Welcome back [insert name here]!
    </div>
    <!-- <p hidden id = invis> Invisible :D</p>
    <button>Visible</button> -->
    <script src="event.js"></script>
</body>
<!-- <script src="script.js"></script> -->

<!-- this is a hidden table which represent the user's schedules.
     once revealed, the user can click on each box and it will toggle between
     lightgreen and mistyrose, representing if they are available at the associated time-->
<div id = "userschedule-div-1">
  <table  style = " border:solid" id = "userschedule-table" hidden>
       <tr id = "user-schedule-row1" style="background-Color:mistyrose" onclick= "changeColor(id)" >
      <td height = "10x">
        
      </td>
    </tr>
    <tr id = "user-schedule-row2" style="background-Color:mistyrose" onclick= "changeColor(id)">
      <td  style = "border-bottom: dotted;" height = "10px" width = "15px">
        
      </td>
    </tr>
    <tr id = "user-schedule-row3" style="background-Color:mistyrose" onclick= "changeColor(id)">
      <td height = "10px">
        
      </td>
    </tr>
       <tr id = "user-schedule-row4" style="background-Color:mistyrose" onclick= "changeColor(id)">
      <td height = "10px">
        
      </td>
    </tr>
    
  </table>
  </div>

<!-- this is a hidden table which represents the groups schedule. 
     This will show the availablity of everyone who have put in their available times
     once revealed and when the user inputs their own availablity-->
  <div id = "groupchedule-div-1">
    <table  style = " border:solid" id = "groupchedule-table" hidden>
         <tr style="background-Color:lightgrey">
        <td height = "10px" width = "15px">
          
        </td>
      </tr>
      <tr style="background-Color:lightgrey">
        <td style = "border-bottom: dotted;" height = "10px" width = "15px">
          
        </td>
      </tr>
      <tr style="background-Color:lightgrey">
        <td height = "10px" width = "15px">
          
        </td>
      </tr>
         <tr style="background-Color:lightgrey">
        <td height = "10px" width = "15px">
          
        </td>
      </tr>
      
    </table>
    </div>


<script>
    var storedName = localStorage.getItem("storedName")
    function save() {
        var item = document.getElementById("username").value;
        localStorage.setItem("storedName", item)
        document.getElementsById("savedText").innerHTML = item + " SAVED";
    }
    function get() {
        localStorage.getItem("storedName");
        document.getElementById("openedText").innerHTML = storedItem + " OPENED";
    }
//this toggles the login_field and successfulLogin_field
    function successfulLogin(){
      var x = document.getElementById("login_field")
      var y = document.getElementById("successfulLogin_field")
      if(y.style.display !== "block"){
        x.style.display = "none";
        y.style.display = "block";
      }else{
        x.style.display = "block";
        y.style.display = "none";
      }
      
    }
//this toggles the background of an element between mistyrose and lightgreen
    function changeColor(id) { 
            const button = document.getElementById(id);
            if (button.style.backgroundColor === "mistyrose") {
                button.style.backgroundColor = "lightgreen";
                button.dataset.selected = "true";
            } else {
                button.style.backgroundColor = "mistyrose";
                button.dataset.selected = "false";
            }
        }
//this toggles the group and user schedules        
  function schedules(){
      var x = document.getElementById("groupchedule-table")
      if(x.style.display !== "block"){
        x.style.display = "block"
      }else{
        x.style.display = "none"
      }
      var a = document.getElementById("userschedule-table")
      if(a.style.display !== "block"){
        a.style.display = "block"
      }else{
        a.style.display = "none"
      }
  }
//this toggles the "eventplanneroptions" element
function howmanyevents(){
  var x = document.getElementById("eventplanneroptions")
  
  if(x.style.display !== "block"){
      x.style.display = "block";
    }else{
    x.style.display = "none";
  }
  
}
</script>

<!-- these are the buttons which, once pressed, call the associated functions-->
<button id = "successfulLogin_button" onclick="successfulLogin()">Successful login</button>
<button id = "schedules_button" onclick= "schedules()"> schedule</button>
<button id = "how_many_events_button"onclick = "howmanyevents()"> How Many Events</button>

<!-- this button, once pressed, calls the slowDown function-->
<div id = "genere_schedules_tables_button">
  <button onclick= "slowDown()">
    Generate Schedules
  </button>
</div>
<script>
  
//this functions generates the schedules for the user to mark their availablity based
//on the days they selected, the start time and end time
 function generateScheduleTables(days = [], startTime, endTime){
   //"sPM" and "ePM" stand for "startTime-PM" and "endTime-PM"
   //these variables are meant to check if the start and end times are in the AM or PM
   // 0 is false, 1 is true
   var sPM = 0;
   var ePM = 0;
   
   //These two variables represent (not keep track, like sPm and ePM) the time (if it's am or pm) 
   //(also, the "M" in am and pm stands for meridian)
   var meridian = "PM";
   var meridian2 = "PM";
   
//This sets "s" (the start time) and "e" (the end time) to the number befor the semi-colon
   var s = startTime.indexOf(":");
   if (s!= 1){ //This checks if the number before the semi-colon is a double digit number
              //by checking the current index of s (if it's not 1, it's a double digit)
   s = startTime[0]+ startTime[1];
   s = parseInt(s);
   }else{
     s = parseInt(startTime[0]);
   }
   
   var e = endTime.indexOf(":");
   if (e!= 1){
   e = endTime[0]+ endTime[1];
   e = parseInt(e);
   }else{
     e = parseInt(endTime[0]);
   }
   
   //this checks if the time is in the "PM"
   for (let i = 5; i < 8; i++){
     if (startTime[i] == "P"){
       sPM = 1; 
       console.log("this works");
     }
     if (endTime[i] == "P"){
       ePM = 1;
       console.log("this also works");
     }
   }
   
   //This creates n amount of tables based on the start and end times
   // for (i = s; i < e; i++){
   
   //This if statement checks if the startime and endtime are both AM or PM
   
   //this changes the value of e (the endtime) to represent military time if the
   //start and end times go from "am"-"pm"
   if ((sPM == 0) && (ePM == 1)){
     e += 12;
   }
   //This loop sets the day and which day the following schedule is for
    for (let i = 0; i != days.length; i++){
        var dow = days[i]; // dow (day.of.week) is the day associated with the current index of the "days" list
        const day = document.createElement("table"); //creates a table
        day.id = `${dow}`; //gives the table an id
        day.style = "float:left"; //makes the tables go towards the left
        //day.textContent = "";
        //table.textContent = "";
        document.body.appendChild(day); //adds the table (which is still empty) to the page
        //const test = document.createElement("div");

        //this creates the 'template' for the table
        let template = `
                  <table>
 
            <tr id = "day-label-${i}">
              <th id = "day-label-header${i}">   </th> <th id = "${dow}-header"style = "font-size:12px"> ${dow} </th>
            </tr>
 
 
          </table>
          `;
       // this 
       day.innerHTML = template;  // this adds the template to empty table
      
      //this loop creates the schedule for the associated day 
      //This works the same as the previous loop, except the conditions are different and the
      //template is different
      for (j = s; j != e; j++){
        var time = j;
        var time2 = j + 1;
        
        if ((sPM == 1) && (ePM == 1)){
          merdian = "PM";
          merdian2 = "PM";
        }
        
        //if j is less than 11 and the start time is in the "AM", both merdians are set to "AM"
        else if ((j < 11) && (sPM == 0)){
          meridian = "AM";
          meridian2 = "AM";
          }
        
        //if j is 11, meridian2 is set to "PM"
        else if (j == 11){
          meridian2 = "PM";
        }
        
        //if j is 12, meridan is set to "PM"
        else if (j == 12){
          meridian = "PM";
          time2 -= 12;
        }
        
        //if j is greater than 12, the time variable is set to j minus 12
        else if (j > 12){
          time = j - 12;
          time2 = j - 11;
        }
        const table = document.createElement("table");
        table.id = `${dow}`+ "-" + j;
        //table.textContent = "";
        document.body.appendChild(table);
        //const test = document.createElement("div");
        console.log(meridian);
        console.log(meridian2);
        let template2 = `    
        <table>
  <tr>
   <td id = "${days[i]}-${j}-borderless-0" style = "text-align:right; font-size:10px"> <sup> ${time} ${meridian}</sup> </td> <td id = "${days[i]}-${j}-0" onclick = "changeColor(id)" style = "border:solid;background-color:mistyrose;  height = "5x" width = 10px> </td>
 </tr>
 
 <tr>
   <td  id = "${days[i]}-${j}-borderless-1" style = "padding:5px"> </td> <td id = "${days[i]}-${j}-1" onclick = "changeColor(id)" style = "border-bottom: dashed; border-left: solid; border-right: solid;background-color:mistyrose; border-top: solid;" height = "5px"></td>
 </tr>
 
 <tr>
   <td id = "${days[i]}-${j}-borderless-2" style= "padding:5px"> </td> <td id = "${days[i]}-${j}-2" onclick = "changeColor(id)" style = "border:solid;background-color:mistyrose" height = "5px"></td>
 </tr>
 
  <tr>
   <td id = "${days[i]}-${j}-borderless-3" style = "text-align:right;font-size:12px"> <sub><small>${time2} ${meridian2}</small></sub> </td> <td id = "${days[i]}-${j}-3" onclick = "changeColor(id)"height = "5px" style = "border:solid;background-color:mistyrose"></td>
 </tr>
 
</table>
`;
      day.innerHTML += template2; 
   }
   }    
   }
 
   
//this calls the generateScheduleTables function
 function slowDown(){
   generateScheduleTables(["Monday", "Thursday"], "10:00 AM", "12:00 PM");
 }
 

</script>
</html>
